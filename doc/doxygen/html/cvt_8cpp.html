
<!-- quan_doxygen_header.html -->
<!-- From Sample custom Doxygen header from my_doxygen_header.html  -->-
<!-- Copyright 1998 - 2012 Paul A. Bristow. -->
<!-- Distributed under the Boost Software License, Version 1.0. -->
<!-- (See accompanying file LICENSE_1_0.txt or copy at          -->
<!-- http://www.boost.org/LICENSE_1_0.txt)                      -->
<html> <!-- </html> is in footer. -->
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/>
  <!-- Add your title here ! -->
  <title>Boost.quan Wed Aug 29 2012 16:29:25 Boost.Quan </title>
  <!-- Add your custom stylesheet here ! -->
  <link href="../quan_doxygen.css" rel="stylesheet" type="text/css"/>
  <!-- Note that this overrides any stylesheet specified in doxyfile setting HTML_STYLESHEET="mystylesheet.css" ! -->
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
</head>
<!-- Add draft background here if, for example, not yet accepted or otherwise not finalised. -->
<body style="background-image: url(../../images/draft.png);">
</body>
<!-- You could also flag status by using a color? -->
<!--<body style="background-image: url(../../images/draft.png) ; color : darkblue"> -->
<!-- </body> is in footer. -->
<!-- Add your logo here or -->
<!-- Boost logo here if accepted after review, else some "Proposed for Boost" logo, for example the one below, or "proposed for Boost" ! -->
<table cellpadding="5" width="100%">
  <tbody>
    <tr>
      <td valign="top"><img alt="Proposed for Boost." src="../proposed_for_boost.png" height="80" width="250"/></td>
    </tr>
  </tbody>
</table>
<p>
  <br/>  <!-- Some space below logo, if needed. -->
</p>
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_737fe0457d95dc419274e8bf895638da.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">cvt.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>floating point double to decimal digit string.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;iostream&gt;</code><br/>
<code>#include &lt;limits&gt;</code><br/>
<code>#include &lt;exception&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;cassert&gt;</code><br/>
</div>
<p><a href="cvt_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae9997ad4fc162e69a766ae2dc42e52f1"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvt_8cpp.html#ae9997ad4fc162e69a766ae2dc42e52f1">cvtbuf</a> (double value, int nDigits, bool isPrecision, int *digitsBeforePoint, bool *isNegative, char *buf)</td></tr>
<tr class="separator:ae9997ad4fc162e69a766ae2dc42e52f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac65bcab060e49516606013221faccb92"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvt_8cpp.html#ac65bcab060e49516606013221faccb92">outcvt</a> (double number, int nDigits=6, ostream &amp;os=cout)</td></tr>
<tr class="separator:ac65bcab060e49516606013221faccb92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77679a1a4d626114c3152c14477f043f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvt_8cpp.html#a77679a1a4d626114c3152c14477f043f">outecvt</a> (double number, int nDigits=6, ostream &amp;os=cout)</td></tr>
<tr class="separator:a77679a1a4d626114c3152c14477f043f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>floating point double to decimal digit string. </p>
<p>This product uses concepts in software developed by the Apache Group for use in the Apache HTTP server project (<a href="http://www.apache.org/">http://www.apache.org/</a>).</p>
<p>Apache code uses some concepts from the SIO stdio-replacement strx_* functions by Panos Tsirigotis <a href="#" onclick="location.href='mai'+'lto:'+'pan'+'os'+'@al'+'um'+'ni.'+'cs'+'.co'+'lo'+'rad'+'o.'+'edu'; return false;">panos<span style="display: none;">.nosp@m.</span>@alu<span style="display: none;">.nosp@m.</span>mni.c<span style="display: none;">.nosp@m.</span>s.co<span style="display: none;">.nosp@m.</span>lorad<span style="display: none;">.nosp@m.</span>o.ed<span style="display: none;">.nosp@m.</span>u</a> for xinetd.</p>
<p>Modified PAB for unc Mar-Jul 2004 to just provide various cvts for C++ only. Unlike MS _ecvt and others, and probably used by printf family, buffer = _ecvt(value, nDigits, &amp;decimal, &amp;sign); works similarly, not rounding fully. for precision(2) it rounds 9.95 up to 10. Failure to round up is when the fraction part it just below 0.5. This happens when closest representable value is just below *.*5 for example, 0.15 with precision 1 gives 0.1, not the common symmetric rounding expectation of 0.2. and leads to unhelpful, unintuitive rounding. In this version, 4 least significant bits are added to the fraction part to ensure that this does not happen, clearly a kludge!</p>
<p>Posted to comp.c++.std newsgroup 26 Oct 2004, but no supporting suggestions. <a class="el" href="cvt_8cpp.html" title="floating point double to decimal digit string.">cvt.cpp</a></p>
<p>#include &lt;iostream&gt;</p>
<p>double d = 9.95; cout &lt;&lt; setprecision(3) &lt;&lt; d &lt;&lt; endl; // Output is 9.95 cout &lt;&lt; setprecision(2) &lt;&lt; d &lt;&lt; endl; // Output is 9.9 or similarly using printf but I might expect precision(2) to round 9.95 up to 10. The reason is, of course, that the nearest floating point representation for 9.95 is 9.9499999999999993 using precision (17) all significant decimal digits or hex 4023e666 66666666 and it fails to round-up 4 followed by anything. The next higher representable value is 9.9500000000000011 4023e666 66666667 &amp; rounds up OK.</p>
<p>If use</p>
<p>cout &lt;&lt; setprecision(3) &lt;&lt; d &lt;&lt; endl; // Output is 9.95</p>
<p>and then apply rounding rules to 9.95 then get the expected 10.0</p>
<p>See also Gay implementation of rounding based on Clinger, and also on Steele and White using big integers but this was not easily implemented - problems with names clashing with stdlib versions. Is a C version and does not use numeric_limits for layout etc. Uses a big integer only when fp register runs out of bits.</p>
<p>Changing numeric_limits rounding style does NOT have any effect on MS (Plauger), because it is hardwired (as says in the MS documentation) so this is not useful either. In any case this is <em>binary</em> rounding, not decimal digits rounding.</p>
<p>Nor does changing the control word to change in the rounding of fp computation have any effect on the iostream output of FP values. </p>

<p>Definition in file <a class="el" href="cvt_8cpp_source.html">cvt.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae9997ad4fc162e69a766ae2dc42e52f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* cvtbuf </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nDigits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isPrecision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>digitsBeforePoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>isNegative</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cvt_8cpp_source.html#l00092">92</a> of file <a class="el" href="cvt_8cpp_source.html">cvt.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac65bcab060e49516606013221faccb92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int outcvt </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nDigits</em> = <code>6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em> = <code>cout</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cvt_8cpp_source.html#l00227">227</a> of file <a class="el" href="cvt_8cpp_source.html">cvt.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a77679a1a4d626114c3152c14477f043f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int outecvt </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nDigits</em> = <code>6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em> = <code>cout</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cvt_8cpp_source.html#l00305">305</a> of file <a class="el" href="cvt_8cpp_source.html">cvt.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- custom Doxygen footer quan_doxygen_footer.html  -->-
<!-- Copyright 2012 Paul A. Bristow -->
<!-- Distributed under the Boost Software License, Version 1.0. -->
<!-- (See accompanying file LICENSE_1_0.txt or copy at          -->
<!-- http://www.boost.org/LICENSE_1_0.txt)                      -->
<hr size="1"/>
<table width="100%">
<tbody>
  <tr>
   <address style="text-align: left;">
     <p>Use, modification and distribution are subject to the Boost Software License, Version 1.0.<br/>
     (See accompanying file LICENSE_1_0.txt or copy at&nbsp;
     <a href="http://www.boost.org/LICENSE_1_0.txt"> http://www.boost.org/LICENSE_1_0.txt </a>)</p>
      <!-- Change copyright to YOUR name (and affiliation, if any) below:  -->
     <p>Copyright © 2012 Paul A. Bristow</p>
      <!-- 2012 becomes the current year, for example 2010, so claims copyright for a range of years, 2009 - 2010. -->
     <p>Doxygen Documentation generated by&nbsp;<a href="http://www.doxygen.org/index.html"> <img src="doxygen.png" alt="doxygen logo" align="middle" border="0"/> 1.8.2</a>, Revised at Wed Aug 29 2012 16:29:25</p>
  </address>
  </tr>
</tbody>
</table>
  <!-- You can also add a footer logo, taking care that the location of the footer.png is correct. -->
  <!-- <img src="../images/my_footer.png" alt="Boost Doxygen documentation footer.png" -->
  </body> <!-- <body> is in doxygen_header.html -->
</html><!-- <html>  is in doxygen_header.html -->
